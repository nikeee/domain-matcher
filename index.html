<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<title>TLD Matcher</title>
</head>

<body class="container">
	<div class="card">
		<div class="card-header">
			<label for="desiredNames"> Desired names </label>
		</div>
		<div class="card-body form-group">
			<textarea id="desiredNames" class="form-control" rows="10"></textarea>
		</div>
	</div>

	<div class="card">
		<div class="card-header">
			Possbile Domains
		</div>
		<ul id="possbileTLDs" class="list-group list-group-flush"></ul>
	</div>
	<script>
		main();
		async function main() {
			const domainsUpper = await fetch("domains.txt").then(r => r.text());
			const domains = domainsUpper
				.toLowerCase()
				.split("\n")
				.filter(line => line.trim() !== "" && !line.trim().startsWith("#"));

			const desiredNames = document.getElementById("desiredNames");
			const possbileTLDs = document.getElementById("possbileTLDs");

			desiredNames.addEventListener("input", ev => {
				const value = ev.target.value;
				possbileTLDs.innerHTML = "";
				if (!value || value.trim() === "")
					return;

				value
					.split("\n")
					.filter(f => !!f && !!f.trim())
					.map(getPossbileTLDs)
					.forEach(ds => {
						ds.map(s => {
							const li = document.createElement("li");
							li.className = "list-group-item";
							const code = document.createElement("code");
							code.textContent = s;
							li.appendChild(code);
							return li;
						}).forEach(li => possbileTLDs.appendChild(li))
					});
			});

			function getPossbileTLDs(full) {
				full = full.toLowerCase();
				const possible = domains.filter(tld => full.endsWith(tld));
				return possible.length === 0
					? [`No match for <${full}>`]
					: possible.map(tld => full.slice(0, -tld.length) + "." + tld);
			}
		}

	</script>
</body>

</html>